!function(){"use strict";const e=new class{constructor(e,t={anonymize_ip:!0}){this.trackingId=e,this.config=t,this.enabled=!1,this.queue=[],window.dataLayer=window.dataLayer||[],this.gtag=function(){window.dataLayer.push(arguments)}}get isEnabled(){return this.enabled}enable(){this.isEnabled||(this.enabled=!0,this.gtag("js",new Date),this.gtag("config",this.trackingId,this.config),this.queue.forEach(e=>this.gtag(...e)),this.queue=[])}event(e,t){this.isEnabled?this.gtag("event",e,t):this.queue.push(["event",e,t])}}("UA-16350314-4"),t=document.createElement("template");let i;t.innerHTML='\n<div part="control"><div part="check"><ui-icon icon="check"></ui-icon></div></div>\n<label part="label"><slot></slot></label>\n';const s='\n:host {\n    --icon-color: #fff;\n    display: inline-grid;\n    grid-template-columns: auto 1fr;\n    column-gap: var(--grid);\n    align-items: center;\n    justify-items: stretch;\n    font: inherit;\n    border-radius: var(--border-radius, .125rem);\n}\n:host input {\n    display: none;\n}\n:host ui-icon {\n    position: absolute;\n    top: 50%;\n    left: 50%;\n    transform: translate(-50%, -50%);\n}\n:host [part="control"] {\n    display: flex;\n    align-items: stretch;\n    justify-content: stretch;\n    height: calc(var(--grid) * 10/6);\n    width: calc(var(--grid) * 10/6);\n    border: var(--border-width, .125rem) solid var(--border-color, #ccc);\n    border-radius: var(--border-radius, .125rem);\n    box-sizing: border-box;\n}\n:host [part="check"] {\n    flex: 1 1 auto;\n    position: relative;\n}\n:host([aria-checked="true"]) [part="control"] {\n    border-color: var(--background-color-active, dodgerblue);\n    background-color: var(--background-color-active, dodgerblue);\n}\n:host([aria-checked="true"]) [part="check"] {\n    background-color: var(--background-color-active, dodgerblue);\n}\n:host([aria-checked="false"]) ui-icon {\n    display: none;\n}\n:host([aria-disabled=true]) {\n    opacity: .5;\n}\n:host(:focus) {\n    outline: none;\n    box-shadow: 0 0 0 .125rem var(--outline-color, dodgerblue);\n}\n';try{i=new CSSStyleSheet,i.replaceSync(s)}catch(e){i=document.createElement("style"),i.innerText=s}let n=0;class r extends HTMLElement{constructor(){super(),this.listeners=new Map;const e=this.constructor.template,t=this.constructor.style;this.attachShadow({mode:"open"}),this.shadowRoot.append(e.content.cloneNode(!0)),t instanceof CSSStyleSheet?this.shadowRoot.adoptedStyleSheets=[t]:this.shadowRoot.prepend(t.cloneNode(!0)),this.id=this.getId(),this.input=this.createHiddenInput(),this.label=this.shadowRoot.querySelector("[part=label]"),this.listeners.set("click",this.handleClick.bind(this)),this.listeners.set("keypress",this.handleKeypress.bind(this))}static get observedAttributes(){return["aria-checked","aria-disabled","name","value"]}get checked(){return this.input.checked}set checked(e){e!==this.checked&&(this.input.checked=e,this.setAttribute("aria-checked",`${e}`))}get disabled(){return this.input.disabled}set disabled(e){e!==this.disabled&&(this.input.disabled=e,e?(this.tabindex=-1,this.setAttribute("aria-disabled","true")):(this.tabindex=0,this.removeAttribute("aria-disabled")))}get tabindex(){return this.disabled?-1:0}set tabindex(e){this.disabled?this.removeAttribute("tabindex"):this.setAttribute("tabindex",`${e}`)}get name(){return this.input.name}set name(e){e!==this.name&&(null!==e?(this.input.name=e,this.setAttribute("name",e)):(this.input.removeAttribute("name"),this.removeAttribute("name")))}get value(){return this.input.value}set value(e){e!==this.value&&(null!==e?(this.input.value=e,this.setAttribute("value",e)):(this.input.removeAttribute("value"),this.removeAttribute("value")))}connectedCallback(){this.setAttribute("role","checkbox"),this.tabindex=0,this.setAttribute("aria-checked",`${this.checked}`),this.label.id=`${this.id}-label`,this.setAttribute("aria-labelledby",this.label.id),this.addListeners()}disconnectedCallback(){this.removeListeners()}attributeChangedCallback(e,t,i){switch(e){case"aria-checked":if(t===i)return;this.checked="true"===i;break;case"aria-disabled":if(t===i)return;this.disabled="true"===i;break;case"name":if(t===i)return;this.name=i;break;case"value":if(t===i)return;this.value=i}}toggle(){this.checked=!this.checked}getId(){return this.id||`check-box-${n++}`}createHiddenInput(){const e=document.createElement("input");return e.type="checkbox",e.checked="true"===this.getAttribute("aria-checked"),e.disabled="true"===this.getAttribute("aria-disabled"),e.setAttribute("aria-hidden","true"),e.setAttribute("style","display: none;"),this.prepend(e),e}addListeners(){this.listeners.forEach((e,t)=>this.addEventListener(t,e))}removeListeners(){this.listeners.forEach((e,t)=>this.removeEventListener(t,e))}handleClick(e){this.disabled||(this.toggle(),this.emitChange())}handleKeypress(e){if("Enter"===e.key||" "===e.key){if(e.preventDefault(),this.disabled)return;this.toggle(),this.emitChange()}}emitChange(){this.dispatchEvent(new Event("change",{bubbles:!0,cancelable:!0,composed:!0}))}}r.template=t,r.style=i,customElements.define("check-box",r);const a=document.createElement("template");a.innerHTML='\n<slot name="header"></slot>\n<slot name="description"></slot>\n<slot></slot>\n';let o=0;class h extends HTMLElement{constructor(){super(),this.header=null,this.description=null,this.attachShadow({mode:"open"}),this.shadowRoot.append(a.content.cloneNode(!0)),this.id=this.id||`form-group-${o++}`,this.header=this.querySelector("[slot=header]"),this.description=this.querySelector("[slot=description]")}connectedCallback(){this.setAttribute("role","group"),this.header&&(this.header.id=this.header.id||`${this.id}-header`,this.setAttribute("aria-labelledby",this.header.id)),this.description&&(this.description.id=this.description.id||`${this.id}-description`,this.setAttribute("aria-describedby",this.description.id))}}customElements.define("form-group",h);const c=document.createElement("template");let d;c.innerHTML='\n<svg focusable="false" aria-hidden="true"><use/></svg>\n';const l="\n:host {\n    display: inline-flex;\n    width: var(--line-height, 1.5rem);\n    height: var(--line-height, 1.5rem);\n    padding: 0;\n    line-height: inherit;\n    font-size: inherit;\n    vertical-align: bottom;\n    box-sizing: border-box;\n}\n:host svg {\n    width: 100%;\n    height: 100%;\n    line-height: inherit;\n    font-size: inherit;\n    overflow: visible;\n    fill: var(--icon-color, currentColor);\n}\n";try{d=new CSSStyleSheet,d.replaceSync(l)}catch(e){d=document.createElement("style"),d.innerText=l}class u extends HTMLElement{constructor(){super();const e=this.constructor.template,t=this.constructor.style;this.attachShadow({mode:"open"}),this.shadowRoot.append(e.content.cloneNode(!0)),t instanceof CSSStyleSheet?this.shadowRoot.adoptedStyleSheets=[t]:this.shadowRoot.prepend(t.cloneNode(!0)),this.use=this.shadowRoot.querySelector("use")}static getObservedAttributes(){return["icon"]}get icon(){return this.getAttribute("icon")}set icon(e){e!==this.icon&&(this.setAttribute("icon",e||""),this.update())}connectedCallback(){this.setAttribute("role","img"),this.setAttribute("aria-hidden","true"),this.update()}attributeChangedCallback(e,t,i){t!==i&&(this.icon=i)}update(){this.use.setAttribute("href",`icons.svg#${this.icon}`)}}let p;u.template=c,u.style=d,customElements.define("ui-icon",u);const b='\n:host {\n    --icon-color: #fff;\n    display: inline-grid;\n    grid-template-columns: auto 1fr;\n    column-gap: var(--grid);\n    align-items: center;\n    justify-items: stretch;\n    font: inherit;\n    border-radius: var(--border-radius, .125rem);\n}\n:host input {\n    display: none;\n}\n:host ui-icon {\n    display: none;\n}\n:host [part="control"] {\n    display: flex;\n    align-items: stretch;\n    justify-content: stretch;\n    height: calc(var(--grid) * 10/6);\n    width: calc(var(--grid) * 10/6);\n    border: var(--border-width) solid var(--border-color, #ccc);\n    border-radius: 50%;\n    box-sizing: border-box;\n}\n:host [part="check"] {\n    flex: 1 1 auto;\n    margin: var(--border-width);\n    border-radius: 50%;\n}\n:host([aria-checked="true"]) [part="control"] {\n    border-color: var(--background-color-active, dodgerblue);\n}\n:host([aria-checked="true"]) [part="check"] {\n    background-color: var(--background-color-active, dodgerblue);\n}\n:host([aria-disabled=true]) {\n    opacity: .5;\n}\n:host(:focus) {\n    outline: none;\n    box-shadow: 0 0 0 .125rem var(--outline-color, dodgerblue);\n}\n';try{p=new CSSStyleSheet,p.replaceSync(b)}catch(e){p=document.createElement("style"),p.innerText=b}let m=0;class v extends r{get checked(){return"true"===this.getAttribute("aria-checked")}set checked(e){e!==this.checked&&(this.input.checked=e,this.setAttribute("aria-checked",`${e}`))}connectedCallback(){super.connectedCallback(),this.setAttribute("role","radio")}getId(){return this.id||`radio-button-${m++}`}createHiddenInput(){const e=document.createElement("input");return e.type="radio",e.checked="true"===this.getAttribute("aria-checked"),e.disabled="true"===this.getAttribute("aria-disabled"),e.setAttribute("aria-hidden","true"),e.setAttribute("style","display: none;"),this.prepend(e),e}handleClick(e){this.disabled||this.checked||(this.checked=!0,this.emitChange())}handleKeypress(e){if("Enter"===e.key||" "===e.key){if(e.preventDefault(),this.disabled||this.checked)return;this.checked=!0,this.emitChange()}}}v.style=p,customElements.define("radio-button",v);customElements.define("radio-group",class extends h{constructor(){super(),this.listeners=new Map,this.active=0,this.radios=this.querySelectorAll("radio-button"),this.listeners.set("change",this.handleChange.bind(this)),this.listeners.set("keydown",this.handleKeypress.bind(this))}connectedCallback(){super.connectedCallback(),this.setAttribute("role","radiogroup"),this.initRadios(),this.addListeners()}disconnectedCallback(){this.removeListeners()}initRadios(){this.radios.forEach((e,t)=>{e.checked?this.active=t:e.tabindex=-1}),this.radios.item(this.active).tabindex=0}nextRadio(e){const t=this.radios.length-1;e=null!=e?e:this.active;do{++e>t&&(e=0)}while(this.radios.item(e).disabled);return e}previousRadio(e){const t=this.radios.length-1;e=null!=e?e:this.active;do{--e<0&&(e=t)}while(this.radios.item(e).disabled);return e}activateRadio(e){const t=this.radios.item(this.active);t.checked=!1,t.tabindex=-1;const i=this.radios.item(e);i.checked=!0,i.tabindex=0,i.focus(),this.active=e}addListeners(){this.listeners.forEach((e,t)=>this.addEventListener(t,e))}removeListeners(){this.listeners.forEach((e,t)=>this.removeEventListener(t,e))}handleChange(e){if(e.target.checked){const t=[...this.radios.entries()].find(([t,i])=>i===e.target)[0];t!==this.active&&this.activateRadio(t)}}handleKeypress(e){switch(e.key){case"ArrowUp":case"ArrowLeft":this.activateRadio(this.previousRadio()),e.preventDefault();break;case"ArrowDown":case"ArrowRight":this.activateRadio(this.nextRadio()),e.preventDefault()}}});const g=document.createElement("template");g.innerHTML='\n<ui-icon icon="angle-down"></ui-icon>\n';class y extends HTMLElement{constructor(){super(),this.append(this.constructor.template.content.cloneNode(!0)),this.select=this.querySelector("select")}connectedCallback(){}}y.template=g,customElements.define("ui-select",y);const f=document.createElement("template");let k;f.innerHTML='\n<slot name="initial"></slot>\n<slot name="loading"></slot>\n<slot name="success"></slot>\n<slot name="error"></slot>\n<slot name="finished"></slot>\n';const S="\n:host {\n    --icon-color: var(--link-color);\n}\n:host slot {\n    display: none;\n}\n:host([state=initial]) slot[name=initial] {\n    display: initial;\n}\n:host([state=loading]) slot[name=loading] {\n    display: initial;\n}\n:host([state=success]) slot[name=success] {\n    display: initial;\n}\n:host([state=error]) slot[name=error] {\n    display: initial;\n}\n:host([state=finished]) slot[name=finished] {\n    display: initial;\n}\n";try{k=new CSSStyleSheet,k.replaceSync(S)}catch(e){k=document.createElement("style"),k.innerText=S}class w extends HTMLElement{constructor(){super();const e=this.constructor.template,t=this.constructor.style;this.attachShadow({mode:"open"}),this.shadowRoot.append(e.content.cloneNode(!0)),t instanceof CSSStyleSheet?this.shadowRoot.adoptedStyleSheets=[t]:this.shadowRoot.prepend(t.cloneNode(!0))}static get observedAttributes(){return["state"]}get state(){return this.getAttribute("state")||"initial"}set state(e){e!==this.state&&(e?this.setAttribute("state",e):this.removeAttribute("state"))}connectedCallback(){this.setAttribute("state",this.state)}}w.template=f,w.style=k,customElements.define("survey-end",w);const E=new Date("2020-07-31"),A={bubbles:!0,cancelable:!0,composed:!0};class x extends HTMLFormElement{constructor(){super(...arguments),this.active=0,this.total=0}connectedCallback(){this.listeners=new Map,this.listeners.set("change",this.handleChange.bind(this)),this.listeners.set("input",this.handleChange.bind(this)),this.listeners.set("next-step",this.handleNextStep.bind(this)),this.listeners.set("previous-step",this.handlePreviousStep.bind(this)),this.end=this.querySelector("survey-end"),this.questions=this.querySelectorAll("survey-question"),this.total=this.questions.length,this.active=0,localStorage.getItem("surveyId")&&(this.active=this.total),this.createProgress(),this.createPrevious(),this.createNext(),E.getTime()<(new Date).getTime()&&this.finishedState(),this.update(),this.addListeners()}disconnectedCallback(){this.removeListeners()}getResult(){return[...new FormData(this).entries()].reduce((e,[t,i])=>(e.hasOwnProperty(t)?(e[t]instanceof Array||(e[t]=[e[t]]),e[t].push(i)):e[t]=i,e),{})}update(){var e,t,i;this.questions.forEach((e,t)=>{t!==this.active?e.setAttribute("aria-hidden","true"):e.removeAttribute("aria-hidden")}),this.active===this.total?(null===(e=this.previous)||void 0===e||e.remove(),null===(t=this.next)||void 0===t||t.remove(),this.end.setAttribute("aria-hidden","false")):(this.end.setAttribute("aria-hidden","true"),this.previous.disabled=0===this.active,this.next.disabled=!(null===(i=this.questions.item(this.active))||void 0===i?void 0:i.isValid()),this.active===this.total-1?(this.next.setAttribute("aria-label","submit"),this.next.querySelector("ui-icon").icon="message"):(this.next.setAttribute("aria-label","next"),this.next.querySelector("ui-icon").icon="check")),this.progress.value=this.active}createNext(){this.next=document.createElement("button"),this.next.type="button",this.next.innerHTML='<ui-icon icon="check"></ui-icon>',this.next.className="next",this.next.setAttribute("aria-label","next"),this.next.addEventListener("click",()=>this.next.dispatchEvent(new Event("next-step",{...A}))),this.append(this.next)}createPrevious(){this.previous=document.createElement("button"),this.previous.type="button",this.previous.innerHTML='<ui-icon icon="arrow-left"></ui-icon>',this.previous.className="previous",this.previous.setAttribute("aria-label","previous"),this.previous.addEventListener("click",()=>this.previous.dispatchEvent(new Event("previous-step",{...A}))),this.append(this.previous)}createProgress(){this.progress=document.createElement("progress"),this.progress.max=this.total,this.progress.value=this.active+1,this.progress.setAttribute("aria-live","polite"),this.prepend(this.progress)}getNextStep(){if(this.active===this.total)return this.total;const e=this.filterSteps();return e[e.indexOf(this.active)+1]}getPreviousStep(){if(0===this.active)return 0;const e=this.filterSteps();return e[e.indexOf(this.active)-1]}filterSteps(){const e=this.getResult();let t=[...this.questions.entries()];return"user"===e.role&&(t=t.filter(([e,t])=>"motivation-contributor"!==t.name&&"frequency"!==t.name)),t.map(([e,t])=>e)}handleChange(){this.update()}handleNextStep(){const e=this.questions.item(this.active),t=!e||e.isValid();this.active<this.total-1&&t?(this.active=this.getNextStep(),this.update()):t&&this.handleSubmit()}handlePreviousStep(){this.active>0&&(this.active=this.getPreviousStep(),this.update())}async handleSubmit(){this.loadingState();const e={...this.getResult(),timestamp:(new Date).getTime()};try{const t=await fetch("https://us-central1-opensourcefunding-8646c.cloudfunctions.net/postSurvey",{headers:{"Content-Type":"application/json"},method:"POST",body:JSON.stringify(e)}),i=await t.text();localStorage.setItem("surveyId",i),this.successState()}catch(e){this.errorState()}}loadingState(){this.active=this.total,this.end.state="loading",this.update(),this.progress.removeAttribute("value")}successState(){this.active=this.total,this.end.state="success",this.update(),this.progress.value=this.active}errorState(){this.active=this.total,this.end.state="error",this.update(),this.progress.value=this.active;const e=this.querySelector(".again"),t=()=>{e.dispatchEvent(new Event("next-step",{...A})),e.removeEventListener("click",t)};e.addEventListener("click",t)}finishedState(){this.active=this.total,this.end.state="finished",this.update()}addListeners(){this.listeners.forEach((e,t)=>this.addEventListener(t,e))}removeListeners(){this.listeners.forEach((e,t)=>this.removeEventListener(t,e))}}customElements.define("survey-form",x,{extends:"form"});class L extends HTMLElement{static get observedAttributes(){return["name","required"]}get name(){return this.getAttribute("name")}set name(e){e!==this.name&&(e?this.setAttribute("name",e):this.removeAttribute("name"))}get required(){return this.hasAttribute("required")&&"false"!==this.getAttribute("required")}set required(e){e!==this.required&&(e?this.setAttribute("required","true"):this.removeAttribute("required"))}attributeChangedCallback(e,t,i){if(t!==i)switch(e){case"name":this.name=i;break;case"required":this.required="false"!==i}}isValid(){const e=new FormData(this.parentElement);return!this.required||(!!e.get(this.name)||!!e.get(`${this.name}-other`))}}customElements.define("survey-question",L);class C{constructor(e){this.routes=e,this.current="",this.handleHashChange=e=>this.navigate(location.hash)}navigate(e){if((e=e.startsWith("#")?e:"#"+e)===this.current)return;const[t,i]=Object.entries(this.routes).find(([t,i])=>t===e||"**"===t)||[];t&&i&&i(t)}start(){window.addEventListener("hashchange",this.handleHashChange),window.dispatchEvent(new HashChangeEvent("hashchange",{oldURL:"",newURL:location.href}))}stop(){window.removeEventListener("hashchange",this.handleHashChange)}}const q=()=>{const t=localStorage.getItem("allowAnalytics");null===t?(()=>{var e,t;const i=document.getElementById("cookie-popup");document.body.append(i.content.cloneNode(!0)),null===(e=document.getElementById("decline_cookies"))||void 0===e||e.addEventListener("click",()=>{var e;localStorage.setItem("allowAnalytics","false"),q(),null===(e=document.body.querySelector(".cookie-popup"))||void 0===e||e.remove()}),null===(t=document.getElementById("accept_cookies"))||void 0===t||t.addEventListener("click",()=>{var e;localStorage.setItem("allowAnalytics","true"),q(),null===(e=document.body.querySelector(".cookie-popup"))||void 0===e||e.remove()})})():"true"===t&&e.enable()},R=t=>{document.querySelectorAll("header > nav a").forEach(e=>{e.href.replace(/^.*?#/,"")===t?e.setAttribute("aria-current","page"):e.removeAttribute("aria-current")}),document.querySelectorAll("main > section").forEach(e=>{e.setAttribute("aria-hidden",JSON.stringify(e.id!==t))}),e.event("screen_view",{screen_name:t})},T={"#home":()=>R("home"),"#survey":()=>R("survey"),"#results":()=>R("results"),"#privacy":()=>R("privacy"),"**":()=>R("home")};async function H(){var e;q(),null===(e=document.querySelector(".call-to-action > button"))||void 0===e||e.addEventListener("click",e=>{e.preventDefault(),document.location.hash="results"}),(e=>{const t=new Date,i=Math.round((e.getTime()-t.getTime())/864e5),s=document.querySelectorAll("[data-days-left]");s.length&&s.forEach(e=>{e.textContent=`${i>0?`in ${i}`:"today"}${i>1?" days":1===i?" day":""}`})})(E),new C(T).start()}window.addEventListener("DOMContentLoaded",()=>{H()})}();
